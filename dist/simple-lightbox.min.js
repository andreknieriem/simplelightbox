/*
	By Andr√© Rinas, www.andrerinas.de
	Available for use under the MIT License
	1.13.0
*/
'use strict';(function(a,b,c){'use strict';a.fn.simpleLightbox=function(f){var w,f=a.extend({sourceAttr:'href',overlay:!0,spinner:!0,nav:!0,navText:['&lsaquo;','&rsaquo;'],captions:!0,captionDelay:0,captionSelector:'img',captionType:'attr',captionsData:'title',captionPosition:'bottom',captionClass:'',close:!0,closeText:'\xD7',swipeClose:!0,showCounter:!0,fileExt:'png|jpg|jpeg|gif',animationSlide:!0,animationSpeed:250,preloading:!0,enableKeyboard:!0,loop:!0,rel:!1,docClose:!0,swipeTolerance:50,className:'simple-lightbox',widthRatio:0.8,heightRatio:0.9,scaleImageToRatio:!1,disableRightClick:!1,disableScroll:!0,alertError:!0,alertErrorMessage:'Image not found, next image will be loaded',additionalHtml:!1,history:!0},f),h=b.navigator.pointerEnabled||b.navigator.msPointerEnabled,j=0,k=0,l=a(),m=function(){var _=c.body||c.documentElement;return _=_.style,''===_.WebkitTransition?'-webkit-':''===_.MozTransition?'-moz-':''===_.OTransition?'-o-':''===_.transition&&''},n=!1,o=[],q=f.rel&&!1!==f.rel?function p(_,aa){var ba=aa.filter(function(){return a(this).attr('rel')===_});return ba}(f.rel,a(this)):this,m=m(),r=0,t=!1!==m,u='pushState'in history,v=!1,x=b.location,y=function(){return x.hash.substring(1)},z=y(),A=function(){var _=y(),aa='pid='+(K+1),ba=x.href.split('#')[0]+'#'+aa;u?history[v?'replaceState':'pushState']('',c.title,ba):v?x.replace(ba):x.hash=aa,v=!0},B=function(){u?history.pushState('',c.title,x.pathname+x.search):x.hash='',clearTimeout(w)},C=function(){v?w=setTimeout(A,800):A()},D='simplelb',E=a('<div>').addClass('sl-overlay'),F=a('<button>').addClass('sl-close').html(f.closeText),G=a('<div>').addClass('sl-spinner').html('<div></div>'),H=a('<div>').addClass('sl-navigation').html('<button class="sl-prev">'+f.navText[0]+'</button><button class="sl-next">'+f.navText[1]+'</button>'),I=a('<div>').addClass('sl-counter').html('<span class="sl-current"></span>/<span class="sl-total"></span>'),J=!1,K=0,L=a('<div>').addClass('sl-caption '+f.captionClass+' pos-'+f.captionPosition),M=a('<div>').addClass('sl-image'),N=a('<div>').addClass('sl-wrapper').addClass(f.className),O=function(_){if(!f.fileExt)return!0;var aa=/\.([0-9a-z]+)(?=[?#])|(\.)(?:[\w]+)$/gmi,ba=a(_).attr(f.sourceAttr).match(aa);return ba&&'a'==a(_).prop('tagName').toLowerCase()&&new RegExp('.('+f.fileExt+')$','i').test(ba)},Q=function(_){_.trigger(a.Event('show.simplelightbox')),f.disableScroll&&(r=Z('hide')),N.appendTo('body'),M.appendTo(N),f.overlay&&E.appendTo(a('body')),J=!0,K=q.index(_),l=a('<img/>').hide().attr('src',_.attr(f.sourceAttr)),-1==o.indexOf(_.attr(f.sourceAttr))&&o.push(_.attr(f.sourceAttr)),M.html('').attr('style',''),l.appendTo(M),U(),E.fadeIn('fast'),a('.sl-close').fadeIn('fast'),G.show(),H.fadeIn('fast'),a('.sl-wrapper .sl-counter .sl-current').text(K+1),I.fadeIn('fast'),R(),f.preloading&&W(),setTimeout(function(){_.trigger(a.Event('shown.simplelightbox'))},f.animationSpeed)},R=function(_){if(l.length){var aa=new Image,ba=a(b).width()*f.widthRatio,ca=a(b).height()*f.heightRatio;aa.src=l.attr('src'),a(aa).on('error',function(){return q.eq(K).trigger(a.Event('error.simplelightbox')),J=!1,n=!0,G.hide(),f.alertError&&alert(f.alertErrorMessage),void(1==_||-1==_?X(_):X(1))}),aa.onload=function(){'undefined'!=typeof _&&q.eq(K).trigger(a.Event('changed.simplelightbox')).trigger(a.Event((1===_?'nextDone':'prevDone')+'.simplelightbox')),f.history&&C(),-1==o.indexOf(l.attr('src'))&&o.push(l.attr('src'));var da=aa.width,ea=aa.height;if(f.scaleImageToRatio||da>ba||ea>ca){var fa=da/ea>ba/ca?da/ba:ea/ca;da/=fa,ea/=fa}a('.sl-image').css({top:(a(b).height()-ea)/2+'px',left:(a(b).width()-da-r)/2+'px'}),G.hide(),l.css({width:da+'px',height:ea+'px'}).fadeIn('fast'),n=!0;var ha,ga='self'==f.captionSelector?q.eq(K):q.eq(K).find(f.captionSelector);if(ha='data'==f.captionType?ga.data(f.captionsData):'text'==f.captionType?ga.html():ga.prop(f.captionsData),f.loop||(0===K&&a('.sl-prev').hide(),K>=q.length-1&&a('.sl-next').hide(),0<K&&a('.sl-prev').show(),K<q.length-1&&a('.sl-next').show()),1==q.length&&a('.sl-prev, .sl-next').hide(),1==_||-1==_){var ia={opacity:1};f.animationSlide&&(t?(T(0,100*_+'px'),setTimeout(function(){T(f.animationSpeed/1e3,'0px')},50)):ia.left=parseInt(a('.sl-image').css('left'))+100*_+'px'),a('.sl-image').animate(ia,f.animationSpeed,function(){J=!1,S(ha,da)})}else J=!1,S(ha,da);f.additionalHtml&&0===a('.sl-additional-html').length&&a('<div>').html(f.additionalHtml).addClass('sl-additional-html').appendTo(a('.sl-image'))}}},S=function(_,aa){''!==_&&'undefined'!=typeof _&&f.captions&&L.html(_).css({width:aa+'px'}).hide().appendTo(a('.sl-image')).delay(f.captionDelay).fadeIn('fast')},T=function(_,aa){var ba={};ba[m+'transform']='translateX('+aa+')',ba[m+'transition']=m+'transform '+_+'s linear',a('.sl-image').css(ba)},U=function(){a(b).on('resize.'+D,R),a(c).on('click.'+D+' touchstart.'+D,'.sl-close',function(fa){fa.preventDefault(),n&&Y()}),f.history&&setTimeout(function(){a(b).on('hashchange.'+D,function(){if(n&&y()===z)return void Y()})},40),H.on('click.'+D,'button',function(fa){fa.preventDefault(),j=0,X(a(this).hasClass('sl-next')?1:-1)});var _=0,aa=0,ba=0,ca=0,da=!1,ea=0;M.on('touchstart.'+D+' mousedown.'+D,function(fa){return!!da||(t&&(ea=parseInt(M.css('left'))),da=!0,j=0,k=0,_=fa.originalEvent.pageX||fa.originalEvent.touches[0].pageX,ba=fa.originalEvent.pageY||fa.originalEvent.touches[0].pageY,!1)}).on('touchmove.'+D+' mousemove.'+D+' pointermove MSPointerMove',function(fa){return!da||void(fa.preventDefault(),aa=fa.originalEvent.pageX||fa.originalEvent.touches[0].pageX,ca=fa.originalEvent.pageY||fa.originalEvent.touches[0].pageY,j=_-aa,k=ba-ca,f.animationSlide&&(t?T(0,-j+'px'):M.css('left',ea-j+'px')))}).on('touchend.'+D+' mouseup.'+D+' touchcancel.'+D+' mouseleave.'+D+' pointerup pointercancel MSPointerUp MSPointerCancel',function(){if(da){da=!1;var ga=!0;f.loop||(0===K&&0>j&&(ga=!1),K>=q.length-1&&0<j&&(ga=!1)),Math.abs(j)>f.swipeTolerance&&ga?X(0<j?1:-1):f.animationSlide&&(t?T(f.animationSpeed/1e3,'0px'):M.animate({left:ea+'px'},f.animationSpeed/2)),f.swipeClose&&50<Math.abs(k)&&Math.abs(j)<f.swipeTolerance&&Y()}})},V=function(){H.off('click','button'),a(c).off('click.'+D,'.sl-close'),a(b).off('resize.'+D),a(b).off('hashchange.'+D)},W=function(){var _=0>K+1?q.length-1:K+1>=q.length-1?0:K+1,aa=0>K-1?q.length-1:K-1>=q.length-1?0:K-1;a('<img />').attr('src',q.eq(_).attr(f.sourceAttr)).on('load',function(){-1==o.indexOf(a(this).attr('src'))&&o.push(a(this).attr('src')),q.eq(K).trigger(a.Event('nextImageLoaded.simplelightbox'))}),a('<img />').attr('src',q.eq(aa).attr(f.sourceAttr)).on('load',function(){-1==o.indexOf(a(this).attr('src'))&&o.push(a(this).attr('src')),q.eq(K).trigger(a.Event('prevImageLoaded.simplelightbox'))})},X=function(_){q.eq(K).trigger(a.Event('change.simplelightbox')).trigger(a.Event((1===_?'next':'prev')+'.simplelightbox'));var aa=K+_;if(!(J||(0>aa||aa>=q.length)&&!1===f.loop)){K=0>aa?q.length-1:aa>q.length-1?0:aa,a('.sl-wrapper .sl-counter .sl-current').text(K+1);var ba={opacity:0};f.animationSlide&&(t?T(f.animationSpeed/1e3,-100*_-j+'px'):ba.left=parseInt(a('.sl-image').css('left'))+-100*_+'px'),a('.sl-image').animate(ba,f.animationSpeed,function(){setTimeout(function(){var ca=q.eq(K);l.attr('src',ca.attr(f.sourceAttr)),-1==o.indexOf(ca.attr(f.sourceAttr))&&G.show(),a('.sl-caption').remove(),R(_),f.preloading&&W()},100)})}},Y=function(){if(!J){var _=q.eq(K),aa=!1;_.trigger(a.Event('close.simplelightbox')),f.history&&B(),a('.sl-image img, .sl-overlay, .sl-close, .sl-navigation, .sl-image .sl-caption, .sl-counter').fadeOut('fast',function(){f.disableScroll&&Z('show'),a('.sl-wrapper, .sl-overlay').remove(),V(),aa||_.trigger(a.Event('closed.simplelightbox')),aa=!0}),l=a(),n=!1,J=!1}},Z=function(_){var aa=0;if('hide'==_){var ba=b.innerWidth;if(!ba){var ca=c.documentElement.getBoundingClientRect();ba=ca.right-Math.abs(ca.left)}if(c.body.clientWidth<ba){var da=c.createElement('div'),ea=parseInt(a('body').css('padding-right'),10);da.className='sl-scrollbar-measure',a('body').append(da),aa=da.offsetWidth-da.clientWidth,a(c.body)[0].removeChild(da),a('body').data('padding',ea),0<aa&&a('body').addClass('hidden-scroll').css({'padding-right':ea+aa})}}else a('body').removeClass('hidden-scroll').css({'padding-right':a('body').data('padding')});return aa};return function P(){f.close&&F.appendTo(N),f.showCounter&&1<q.length&&(I.appendTo(N),I.find('.sl-total').text(q.length)),f.nav&&H.appendTo(N),f.spinner&&G.appendTo(N)}(),q.on('click.'+D,function(_){if(O(this)){if(_.preventDefault(),J)return!1;Q(a(this))}}),a(c).on('click.'+D+' touchstart.'+D,function(_){n&&f.docClose&&0===a(_.target).closest('.sl-image').length&&0===a(_.target).closest('.sl-navigation').length&&Y()}),f.disableRightClick&&a(c).on('contextmenu','.sl-image img',function(){return!1}),f.enableKeyboard&&a(c).on('keyup.'+D,function(_){if(j=0,n){_.preventDefault();var aa=_.keyCode;27==aa&&Y(),(37==aa||39==_.keyCode)&&X(39==_.keyCode?1:-1)}}),this.open=function(_){_=_||a(this[0]),Q(_)},this.next=function(){X(1)},this.prev=function(){X(-1)},this.close=function(){Y()},this.destroy=function(){a(c).off('click.'+D).off('keyup.'+D),Y(),a('.sl-overlay, .sl-wrapper').remove(),this.off('click')},this.refresh=function(){this.destroy(),a(this).simpleLightbox(f)},this}})(jQuery,window,document);
